# import * from "./generated/prisma.graphql"

type Query {
  me: User
  # admin
  graphs(
    dataPoints: Int
    active: Boolean # default false (if not set, return all graphs)
  ): [Graph!]!
  graph(id: ID!, dataPoints: Int): Graph # admin and participating user
  # admin
  mediaStreams(
    active: Boolean # default false (if not set, return all mediaStreams)
  ): [MediaStream!]!
  mediaStream(id: ID!): MediaStream # admin and participating user
  brewingProcesses: [BrewingProcess!]! # admin
  brewingProcess(id: ID!): BrewingProcess # admin and participating users
}

type Mutation {
  signup(email: String!, name: String!, password: String!): User!
  signin(email: String!, password: String!): User!
  signout: SuccessMessage

  # admin
  addGraphData(
    sensorName: String!
    sensorTimeStamp: DateTime!
    sensorValue: String!
  ): GraphData!

  # admin
  createGraph(
    name: String!
    sensorName: String!
    updateFrequency: Int
    brewingProcessId: ID!
  ): Graph!

  # admin
  deleteGraph(id: ID!): Graph!

  # admin
  createBrewingProcess(
    name: String!
    startNow: Boolean # default: no
    description: String!
    brewingProcessDetails: DetailsInput!
  ): BrewingProcess!

  # admin
  advanceBrewingProcess(
    id: ID!
    newActiveSteps: [BrewingStep!]!
  ): BrewingProcess!

  # admin
  deleteBrewingProcess(id: ID!): BrewingProcess!
}

input DetailsInput {
  # predetermined recipe values
  # hops only added via hop additions
  malts: [IngredientInput!]!
  yeast: IngredientInput!

  mashWaterLiter: Float!
  spargingWaterLiter: Float!
  yieldsLiter: Float!
  carbonizationGramPerLiter: Float!
  mashInTemperature: Float!
  mashSteps: [StepInput!]!
  spargingTemperature: Float!
  boilingMinutes: Int!
  boilHopAdditions: [HopAddition!]!
  dryHopping: IngredientInput
  fermentationSteps: [StepInput!]!

  # to be added during/after brewing
  originalExtractPlato: Float
  pitchingTemperature: Float
  alcoholPercent: Float
  conditioningDays: Int # days until botteling
}

input IngredientInput {
  name: String!
  amountGram: Float!
  details: String
  type: IngredientType!
}

input StepInput {
  durationMinutes: Int!
  temperature: Float!
  details: String
}

input HopAddition {
  hop: IngredientInput! # add hops here
  minutesAfterBoilStart: Int!
}

type User {
  id: ID!
  email: String!
  name: String!
  permissions: [Permission!]!
  participatingBrewingProcesses: [BrewingProcess!]!
  token: String! #instead of password
}

type SuccessMessage {
  message: String
}
